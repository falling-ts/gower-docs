<!DOCTYPE html>
<html lang="en-US">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Go/Gin Gower is a project based on the Go language and the Gin framework.">
<meta name="author" content="falling-ts">

<title>db-Database Service · Go/Gin Gower Docs</title>

<link rel="canonical" href="//localhost:1313/en/single/db-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/">









<link rel="stylesheet" href="../../../scss/base.css" integrity="">



<link rel="stylesheet" href="../../../scss/theme/default.css" integrity="">



  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  
  <link rel="stylesheet" href="../../../scss/component/docsearch.css" integrity=""/>

<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../img/icon/favicon.ico">
<link rel="icon" href="../../../img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="../../../img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="../../../img/icon/icon-180.png" sizes="180x180">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-00000000"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-00000000');
</script>


  

  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="../../../">Go/Gin Gower Docs</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          
          <li role="menuitem"><a href="//localhost:1313/single/db-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/">中文</a></li>
          
          <li role="menuitem"><a href="//localhost:1313/en/single/db-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/">English</a></li>
          
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="../../../" ><svg t="1731853730249" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="883" width="200" height="200"><path d="M466.48888853 821.99893333A182.13546667 182.13546667 0 0 1 512 463.64444479a182.0444448 182.0444448 0 0 1 45.51111147 358.35448854V918.75555519h227.5555552v-364.08888853a45.51111147 45.51111147 0 0 1 45.51111146-45.51111147h17.93137707L512 206.27911146 175.4908448 509.15555519H193.42222187a45.51111147 45.51111147 0 0 1 45.51111146 45.51111147v364.08888853h91.02222187a45.51111147 45.51111147 0 0 1 0 91.02222294H193.42222187a45.51111147 45.51111147 0 0 1-45.5111104-45.51111147v-364.08888853H56.88888853c-41.68817813 0-61.44-51.4275552-30.44693333-79.32586667l455.11111147-409.6a45.51111147 45.51111147 0 0 1 60.89386666 0l455.11111147 409.6C1028.55111147 548.75022186 1008.79928853 600.17777813 967.11111147 600.17777813h-91.02222294v364.08888853a45.51111147 45.51111147 0 0 1-45.5111104 45.51111147h-318.57777813a45.51111147 45.51111147 0 0 1-45.51111147-45.51111147v-142.26773333zM512 736.71111146a91.02222187 91.02222187 0 1 0 0-182.0444448 91.02222187 91.02222187 0 0 0 0 182.0444448z" fill="#2c2c2c" p-id="884"></path></svg>Home</a></li>
        
          
          <li><a href="../../../workspace/%E4%BB%8B%E7%BB%8D/" ><svg t="1731853749882" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1030" width="200" height="200"><path d="M941.48136843 320.91117833a58.73434594 58.73434594 0 0 0-29.56686-50.74309969L546.72469031 61.2022452a58.73434594 58.73434594 0 0 0-58.73434594 1e-8l-363.59044406 211.76239406a58.73434594 58.73434594 0 0 0-28.76811094 51.14247468v420.72729094a58.73434594 58.73434594 0 0 0 29.56592344 50.74309969l363.59231906 208.16614594a58.73434594 58.73434594 0 0 0 58.33403344 0l365.18981812-210.9627075a58.73434594 58.73434594 0 0 0 29.56686-51.14247469zM516.75939281 122.73315177l307.65453375 176.20303781-141.84086625 90.69745406-134.24993344-76.71371156a59.93247001 59.93247001 0 0 0-59.9315325 0L353.74134843 392.8305177l-142.24024125-91.4971425z m0 567.76284281l-119.86494094-69.12184125 114.27181875-70.72121437L623.43746437 630.56352364zM382.11008437 453.96111177l105.480885-61.53090656v105.48182249a25.17186281 25.17186281 0 0 0 0 2.79656063h-4.39499719l-100.68745031 64.32840562z m161.81804437 44.35029094V388.83489458l112.27400719 63.12840563V581.41792302L542.72812967 501.50827583a27.56904844 27.56904844 0 0 0 2e-8-4.79437312zM163.55550562 351.27678833l150.6308625 95.49276469v170.60803968a59.93247001 59.93247001 0 0 0 29.96623501 51.54278719l140.64180561 79.90964813v173.00616375l-319.64046561-183.39365907z m389.56199344 570.9587775V749.23033958l141.44055468-79.90964719a59.93247001 59.93247001 0 0 0 29.9671725-51.94216219V445.57049146l150.23148844-95.09245313V737.6428452z m0 0" fill="#2c2c2c" p-id="1031"></path></svg>Workspace Mode</a></li>
        
          
          <li><a href="../../../single/%E5%89%8D%E8%A8%80/" ><svg t="1731853765799" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1314" width="200" height="200"><path d="M512 57.5822816c-262.31427627 0-475.75105173 213.43493973-475.75105173 475.75105173 0 262.3491392 213.40191147 475.75105173 475.75105173 475.75105173S987.75105173 795.68247253 987.75105173 533.33333333C987.75105173 271.01905706 774.3491392 57.5822816 512 57.5822816zM512 940.8177184c-224.6992608 0-407.48438507-182.81815147-407.48438507-407.48438507 0-224.6992608 182.78328853-407.48438507 407.48438507-407.48438507 224.66623253 0 407.48438507 182.78328853 407.48438507 407.48438507C919.48438507 757.99956586 736.66623253 940.8177184 512 940.8177184z" fill="#2c2c2c" p-id="1315"></path><path d="M512 362.667584c-94.1054304 0-170.667584 76.56031893-170.667584 170.66574933s76.56031893 170.667584 170.667584 170.667584 170.667584-76.56031893 170.667584-170.667584S606.1054304 362.667584 512 362.667584z" fill="#2c2c2c" p-id="1316"></path></svg>Single Mode</a></li>
        
      </ul>
    </nav>
  </div>

  
  <div id="site-header-search"></div>
</header>
    
<div id="site-main-content-wrapper">
  
  
    


<aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">Introduction</strong>
          
          <a id="en-0-0" class="sidebar-link " href="../../../en/single/preface/#en-0-0">
            
              Preface
            
          </a>
        
          
          <a id="en-0-1" class="sidebar-link " href="../../../en/single/installation/#en-0-1">
            
              Installation
            
          </a>
        
          
          <a id="en-0-2" class="sidebar-link " href="../../../en/single/directory-structure/#en-0-2">
            
              Directory Structure
            
          </a>
        <strong class="sidebar-section">Basic Content</strong>
          
          <a id="en-1-0" class="sidebar-link " href="../../../en/single/routing/#en-1-0">
            
              Routing
            
          </a>
        
          
          <a id="en-1-1" class="sidebar-link " href="../../../en/single/controllers/#en-1-1">
            
              Controllers
            
          </a>
        
          
          <a id="en-1-2" class="sidebar-link " href="../../../en/single/request-validator/#en-1-2">
            
              Request Validator
            
          </a>
        
          
          <a id="en-1-3" class="sidebar-link " href="../../../en/single/exceptions/#en-1-3">
            
              Exceptions
            
          </a>
        
          
          <a id="en-1-4" class="sidebar-link " href="../../../en/single/responses/#en-1-4">
            
              Responses
            
          </a>
        <strong class="sidebar-section">Frontend Related</strong>
          
          <a id="en-2-0" class="sidebar-link " href="../../../en/single/templates/#en-2-0">
            
              Templates
            
          </a>
        
          
          <a id="en-2-1" class="sidebar-link " href="../../../en/single/frontend-build/#en-2-1">
            
              Frontend Build
            
          </a>
        
          
          <a id="en-2-2" class="sidebar-link " href="../../../en/single/packaging/#en-2-2">
            
              Packaging
            
          </a>
        <strong class="sidebar-section">Service Introduction</strong>
          
          <a id="en-3-0" class="sidebar-link " href="../../../en/single/auth-jwt-service/#en-3-0">
            
              auth-JWT Service
            
          </a>
        
          
          <a id="en-3-1" class="sidebar-link " href="../../../en/single/cache-cache-service/#en-3-1">
            
              cache-Cache Service
            
          </a>
        
          
          <a id="en-3-2" class="sidebar-link " href="../../../en/single/config-configuration-service/#en-3-2">
            
              config-Configuration Service
            
          </a>
        
          
          <a id="en-3-3" class="sidebar-link " href="../../../en/single/cookie-cookie-service/#en-3-3">
            
              cookie-Cookie Service
            
          </a>
        
          
          <a id="en-3-4" class="sidebar-link " href="../../../en/single/db-database-service/#en-3-4">
            
              db-Database Service
            
          </a>
        
          
          <a id="en-3-5" class="sidebar-link " href="../../../en/single/exception-exception-service/#en-3-5">
            
              exception-Exception Service
            
          </a>
        
          
          <a id="en-3-6" class="sidebar-link " href="../../../en/single/logger-logging-service/#en-3-6">
            
              logger-Logging Service
            
          </a>
        
          
          <a id="en-3-7" class="sidebar-link " href="../../../en/single/passwd-password-hashing-service/#en-3-7">
            
              passwd-Password Hashing Service
            
          </a>
        
          
          <a id="en-3-8" class="sidebar-link " href="../../../en/single/response-response-service/#en-3-8">
            
              response-Response Service
            
          </a>
        
          
          <a id="en-3-9" class="sidebar-link " href="../../../en/single/route-routing-service/#en-3-9">
            
              route-Routing Service
            
          </a>
        
          
          <a id="en-3-10" class="sidebar-link " href="../../../en/single/symcrypt-symmetric-encryption-service/#en-3-10">
            
              symcrypt-Symmetric Encryption Service
            
          </a>
        
          
          <a id="en-3-11" class="sidebar-link " href="../../../en/single/translate-translation-service/#en-3-11">
            
              translate-Translation Service
            
          </a>
        
          
          <a id="en-3-12" class="sidebar-link " href="../../../en/single/upload-upload-service/#en-3-12">
            
              upload-Upload Service
            
          </a>
        
          
          <a id="en-3-13" class="sidebar-link " href="../../../en/single/util-utility-service/#en-3-13">
            
              util-Utility Service
            
          </a>
        
          
          <a id="en-3-14" class="sidebar-link " href="../../../en/single/validator-validation-service/#en-3-14">
            
              validator-Validation Service
            
          </a>
        <strong class="sidebar-section">Third-party Applications</strong>
          
          <a id="en-4-0" class="sidebar-link " href="../../../en/single/caddy-web-server/#en-4-0">
            
              Caddy Web Server
            
          </a>
        
          
          <a id="en-4-1" class="sidebar-link " href="../../../en/single/log-viewer/#en-4-1">
            
              Log Viewer
            
          </a>
        
          
          <a id="en-4-2" class="sidebar-link " href="../../../en/single/database/#en-4-2">
            
              Database
            
          </a>
        <strong class="sidebar-section">Release</strong>
          
          <a id="en-5-0" class="sidebar-link " href="../../../en/single/release-preface/#en-5-0">
            
              Release Preface
            
          </a>
        
          
          <a id="en-5-1" class="sidebar-link " href="../../../en/single/development-release/#en-5-1">
            
              Development Release
            
          </a>
        
          
          <a id="en-5-2" class="sidebar-link " href="../../../en/single/testing-release/#en-5-2">
            
              Testing Release
            
          </a>
        
          
          <a id="en-5-3" class="sidebar-link " href="../../../en/single/production-release/#en-5-3">
            
              Production Release
            
          </a>
        <strong class="sidebar-section">Other</strong>
          
          <a id="en-6-0" class="sidebar-link " href="../../../en/single/configuration/#en-6-0">
            
              Configuration
            
          </a>
        
          
          <a id="en-6-1" class="sidebar-link " href="../../../en/single/testing/#en-6-1">
            
              Testing
            
          </a>
        
          
          <a id="en-6-2" class="sidebar-link " href="../../../en/single/utils/#en-6-2">
            
              Utils
            
          </a>
        
          
          <a id="en-6-3" class="sidebar-link " href="../../../en/single/commands/#en-6-3">
            
              Commands
            
          </a>
        
          
          <a id="en-6-4" class="sidebar-link " href="../../../en/single/advanced-data-processing/#en-6-4">
            
              Advanced Data Processing
            
          </a>
        
  </div>
</aside>

  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  <button id="article-nav-toc-btn"><i class="icon icon-toc"></i> On this page</button>
</nav>
      <header id="article-header">
  <h1>db-Database Service</h1>
</header>
      <div id="article-content">
        
        
        <h2 id="使用的开源库">使用的开源库</h2>
<pre tabindex="0"><code>&#34;gorm.io/gorm&#34;
</code></pre><h2 id="服务提供者">服务提供者</h2>
<h3 id="服务标识符">服务标识符</h3>
<pre tabindex="0"><code>&#34;db&#34;
</code></pre><h3 id="注册服务">注册服务</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">P</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="s">&#34;db&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">()</span> <span class="p">(</span><span class="nx">Depends</span><span class="p">,</span> <span class="nx">Resolve</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">Depends</span><span class="p">{</span><span class="s">&#34;config&#34;</span><span class="p">,</span> <span class="s">&#34;logger&#34;</span><span class="p">},</span> <span class="kd">func</span><span class="p">(</span><span class="nx">ss</span> <span class="o">...</span><span class="nx">services</span><span class="p">.</span><span class="nx">Service</span><span class="p">)</span> <span class="nx">services</span><span class="p">.</span><span class="nx">Service</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">db</span><span class="p">.</span><span class="nf">New</span><span class="p">().</span><span class="nf">Init</span><span class="p">(</span><span class="nx">ss</span><span class="o">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><h3 id="注册服务格式见-auth-服务">注册服务格式见 auth 服务</h3>
<h2 id="依赖的服务">依赖的服务</h2>
<pre tabindex="0"><code>&#34;config&#34;, &#34;logger&#34;
</code></pre><h2 id="env-配置">ENV 配置</h2>
<pre tabindex="0"><code>DB_DRIVER=sqlite
DB_USER=root
DB_PASSWD=root
DB_NET=tcp
DB_HOST=tidb
DB_PORT=4000
DB_NAME=gower

# 最大数据库连接
DB_MAX_OPEN=100
# 最大数据库空闲连接
DB_MAX_IDLE_COUNT=25
# 数据库连接最大生存时间
DB_MAX_LIFE_TIME=30m
# 数据库空闲连接最大生存时间
DB_MAX_IDLE_TIME=10m

# 是否禁用自动迁移时, 创建外键, 默认禁用
DB_DISABLE_FOREIGN_KEY=true
# 是否跳过默认开启事务, 默认跳过
DB_SKIP_DEFAULT_TRANSACTION=true
# 时区: sys, utc, beijing
DB_TIMEZONE=beijing
# 是否开启预编译缓存, 默认开启
DB_PREPARE_STMT=true
# 是否启用 mysql_native_password, 默认启用
DB_MYSQL_NATIVE_PASSWORDS=true
</code></pre><h2 id="服务接口方法">服务接口方法</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">DBService</span> <span class="kd">interface</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Service</span> <span class="c1">// 通用服务接口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 自动迁移数据库结构
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">AutoMigrate</span><span class="p">(</span><span class="nx">dst</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="kt">error</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于处理关联数据, 它是用于加载、添加、替换和删除关联数据的高级 API.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Association</span><span class="p">(</span><span class="nx">column</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">Association</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于设置默认值, 当您尝试创建一个新的记录时, 如果未提供某些字段的值, Attrs 方法允许您为这些字段指定默认值.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Attrs</span><span class="p">(</span><span class="nx">attrs</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询或创建记录时指定某些字段的值, 它常与 FirstOrXXX 系列方法（如 FirstOrCreate）配合使用, 以便在查找或创建记录时预先指定或修改某些字段的值.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Assign</span><span class="p">(</span><span class="nx">attrs</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于向当前的 gorm.DB 实例中添加错误信息. 这在某些情况下很有用, 例如, 当您需要将自定义错误与 GORM 生成的错误一起处理时.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">AddError</span><span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于开始一个新的事务. 在数据库操作中, 事务用于确保一组操作在成功时被提交, 或在失败时被回滚, 以保持数据的一致性.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Begin</span><span class="p">(</span><span class="nx">opts</span> <span class="o">...*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">TxOptions</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在数据库中创建新记录. 给定一个包含数据的结构体实例, GORM 会根据结构体的定义自动创建相应的 SQL 插入语句, 并执行插入操作.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Create</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在数据库中批量创建新记录. 与 Create 方法类似, 但它允许您指定一个批处理大小, 以便将多个记录分组插入. 这对于插入大量数据时提高性能非常有帮助.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">CreateInBatches</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">batchSize</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于查询满足给定条件的记录数量. 当你需要获取数据库中满足某些条件的记录数时, 可以使用 Count 方法。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Count</span><span class="p">(</span><span class="nx">count</span> <span class="o">*</span><span class="kt">int64</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Connection</span><span class="p">(</span><span class="nx">fc</span> <span class="kd">func</span><span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 提交事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Commit</span><span class="p">()</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加自定义的 SQL 子句. 当您需要执行包含特殊子句的查询时, 可以使用 Clauses 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Clauses</span><span class="p">(</span><span class="nx">conds</span> <span class="o">...</span><span class="nx">clause</span><span class="p">.</span><span class="nx">Expression</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 DISTINCT 子句. DISTINCT 子句用于返回不同（唯一）的结果, 当您需要获取某个字段的不重复值时, 可以使用 Distinct 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Distinct</span><span class="p">(</span><span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中删除满足给定条件的记录. Delete 方法会生成相应的 SQL 删除语句, 并执行删除操作.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Delete</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在执行 SQL 语句之前将其输出到控制台. 这对于调试数据库查询和操作时查看实际执行的 SQL 语句非常有用.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Debug</span><span class="p">()</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 获取 database/sql 的 DB
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">SqlDB</span><span class="p">()</span> <span class="p">(</span><span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于执行原始 SQL 语句. 在某些情况下, 您可能需要执行一些不受 GORM 本身支持的 SQL 语句或操作, 此时可以使用 Exec 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Exec</span><span class="p">(</span><span class="nx">sql</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">values</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中查询满足给定条件的第一条记录. First 方法会生成相应的 SQL 查询语句, 并执行查询操作, 将查询结果填充到提供的结构体实例中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">First</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中查询满足给定条件的所有记录. Find 方法会生成相应的 SQL 查询语句, 并执行查询操作, 将查询结果填充到提供的结构体实例或结构体实例的切片中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Find</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于批量查询满足给定条件的所有记录. FindInBatches 方法在处理大量数据时特别有用, 因为它允许您按指定的批处理大小查询数据, 而不是一次性加载所有记录到内存中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">FindInBatches</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">batchSize</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">fc</span> <span class="kd">func</span><span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">,</span> <span class="nx">batch</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">error</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中查询满足给定条件的第一条记录, 如果没有找到记录, 则初始化一个新的结构体实例. 该方法在需要获取或初始化一个记录时非常有用.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">FirstOrInit</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中查询满足给定条件的第一条记录, 如果没有找到记录, 则创建一个新的记录. 该方法在需要获取或创建一个记录时非常有用.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">FirstOrCreate</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 GROUP BY 子句. GROUP BY 子句用于将结果集按照指定的列进行分组, 通常与聚合函数（如 COUNT、SUM、AVG 等）一起使用.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Group</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从当前 *gorm.DB 实例的存储中获取与给定键关联的值. 这可以用来在 GORM 中存储和检索与特定数据库操作相关的自定义数据.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Get</span><span class="p">(</span><span class="nx">key</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kd">interface</span><span class="p">{},</span> <span class="kt">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 获取 GormDB
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">GormDB</span><span class="p">()</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 HAVING 子句. HAVING 子句用于过滤聚合函数的结果, 通常与 GROUP BY 一起使用.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Having</span><span class="p">(</span><span class="nx">query</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 INNER JOIN 子句. INNER JOIN 子句用于将多个表的记录组合在一起, 基于指定的连接条件. 只有满足连接条件的记录会被包含在结果集中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">InnerJoins</span><span class="p">(</span><span class="nx">query</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将一个值与给定的键关联并存储在当前 *gorm.DB 实例的存储中. 这可以用来在 GORM 中存储和检索与特定数据库操作相关的自定义数据.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">InstanceSet</span><span class="p">(</span><span class="nx">key</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从当前 *gorm.DB 实例的存储中获取与给定键关联的值.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">InstanceGet</span><span class="p">(</span><span class="nx">key</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kd">interface</span><span class="p">{},</span> <span class="kt">bool</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 JOIN 子句. JOIN 子句用于将多个表的记录组合在一起, 基于指定的连接条件. Joins 方法允许您自定义连接类型, 如 INNER JOIN、LEFT JOIN 等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Joins</span><span class="p">(</span><span class="nx">query</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中查询满足给定条件的最后一条记录. Last 方法会生成相应的 SQL 查询语句, 并执行查询操作, 将查询结果填充到提供的结构体实例中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Last</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 LIMIT 子句. LIMIT 子句用于限制查询结果集中的记录数量. 在分页查询或仅需要查询固定数量的记录时, 可以使用 Limit 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Limit</span><span class="p">(</span><span class="nx">limit</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于返回一个 gorm.Migrator 接口实现. 通过 Migrator, 您可以执行数据库迁移操作, 例如创建表、删除表、修改表结构等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Migrator</span><span class="p">()</span> <span class="nx">gorm</span><span class="p">.</span><span class="nx">Migrator</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于设置当前查询或操作的主要表. 该方法将当前 *gorm.DB 实例的模型设置为给定的结构体实例或结构体指针. 在执行查询、插入、更新或删除操作时, 这个模型将作为主要表.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Model</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 NOT 条件. Not 方法用于在查询中添加一个否定的条件, 即查询满足非给定条件的记录. 它可以用于过滤不满足某些条件的记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Not</span><span class="p">(</span><span class="nx">query</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在执行创建（Create）或更新（Update）操作时忽略指定的列. 当您不希望将某些字段插入或更新到数据库中时, 可以使用 Omit 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Omit</span><span class="p">(</span><span class="nx">columns</span> <span class="o">...</span><span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 OR 条件. Or 方法用于在查询中添加一个或多个附加条件, 即查询满足给定条件之一的记录. 它可以用于组合多个条件, 以便查询具有更宽松的约束.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Or</span><span class="p">(</span><span class="nx">query</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 ORDER BY 子句. ORDER BY 子句用于按指定的列对结果集进行排序. 在需要对查询结果进行排序时, 可以使用 Order 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Order</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时添加 OFFSET 子句. OFFSET 子句用于从结果集中的指定位置开始返回记录. 在分页查询或需要跳过前几条记录时, 可以使用 Offset 方法.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Offset</span><span class="p">(</span><span class="nx">offset</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中获取指定列的值列表, 并将其存储到指定的切片中. Pluck 方法可以用于快速获取指定列的值, 而不必返回整个记录. 它通常与 Select 方法一起使用, 以便同时获取多个列的值.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Pluck</span><span class="p">(</span><span class="nx">column</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">dest</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询相关联的记录时预加载（eager loading）关联的记录. 通过预加载关联的记录, 可以避免在使用关联数据时产生额外的查询操作. 预加载通常使用在查询具有多对一或一对多关联的记录时.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Preload</span><span class="p">(</span><span class="nx">query</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询或操作中直接使用原始 SQL 语句. Raw 方法可以让您使用 SQL 语句执行更高级的操作, 例如联接查询、子查询、事务等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Raw</span><span class="p">(</span><span class="nx">sql</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">values</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在执行查询时返回单行记录的结果. Row 方法仅返回匹配条件的第一行记录, 如果未找到任何记录, 则返回一个空行.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Row</span><span class="p">()</span> <span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">Row</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于执行查询并返回多行结果. Rows 方法返回的是 *sql.Rows 类型, 可以通过迭代 Rows 中的记录来获取查询结果集中的每一行.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Rows</span><span class="p">()</span> <span class="p">(</span><span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">Rows</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在事务中回滚之前执行的操作. 在使用事务进行数据库操作时, 如果出现错误或需要取消当前操作, 可以使用 Rollback 方法回滚事务, 撤销之前执行的所有操作.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Rollback</span><span class="p">()</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于回滚事务中到指定保存点之间的所有更改. 保存点是事务处理中一个逻辑上的标记, 用于标记当前事务中的某个位置, 从而在之后的操作中可以方便地回滚到该位置.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">RollbackTo</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将给定的结构体实例插入到数据库中或更新数据库中已有的记录. 如果给定结构体实例的主键字段的值为空, 则 Save 方法将执行插入操作. 如果给定结构体实例的主键字段的值非空, 则 Save 方法将执行更新操作.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Save</span><span class="p">(</span><span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将查询结果的第一行扫描到给定的结构体实例中. Scan 方法用于获取查询结果的第一行, 例如计算查询结果集中的总行数、查询某个特定值等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Scan</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将查询结果中的所有行扫描到给定的结构体实例中. ScanRows 方法可以用于从查询结果中检索多行数据.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">ScanRows</span><span class="p">(</span><span class="nx">rows</span> <span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">Rows</span><span class="p">,</span> <span class="nx">dest</span> <span class="kd">interface</span><span class="p">{})</span> <span class="kt">error</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在事务中创建一个保存点（Save Point）. 保存点是事务处理中一个逻辑上的标记, 用于标记当前事务中的某个位置, 从而在之后的操作中可以方便地回滚到该位置.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">SavePoint</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时指定要选择的列. 通过 Select 方法, 可以从查询结果中只选择所需的列, 以便减少网络流量和提高查询性能.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Select</span><span class="p">(</span><span class="nx">query</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在查询时应用指定的一组作用域（Scope）. 作用域是一组指定了一组查询条件或行为的函数, 可以使用 Scopes 方法将它们应用到查询中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Scopes</span><span class="p">(</span><span class="nx">funcs</span> <span class="o">...</span><span class="kd">func</span><span class="p">(</span><span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于为当前的数据库操作创建一个新的会话（Session）. 在 GORM 中, Session 是一个抽象的概念, 代表着一系列的数据库操作, 它包括开始事务、执行查询、插入数据等操作. 通过 Session, 您可以灵活地控制每个操作的一些行为, 例如事务隔离级别、查询缓存、错误处理等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Session</span><span class="p">(</span><span class="nx">config</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">Session</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于设置 GORM 的全局选项. GORM 提供了许多全局选项, 可以控制数据库连接池的大小、SQL 日志记录、查询缓存等.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Set</span><span class="p">(</span><span class="nx">key</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于在多对多关联中设置关联表的表名以及外键的名称.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">SetupJoinTable</span><span class="p">(</span><span class="nx">model</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">field</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">joinTable</span> <span class="kd">interface</span><span class="p">{})</span> <span class="kt">error</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于指定要在哪个数据库表上执行操作. 在 GORM 中, 每个模型都与一个数据库表相关联. 通过 Table 方法, 可以更改当前操作的默认表, 以便在其他表上执行数据库操作.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Table</span><span class="p">(</span><span class="nx">name</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于从数据库中获取一条记录, 并将其扫描到指定的结构体实例中. Take 方法类似于 First 方法, 但它不会对查询结果进行排序, 而是直接返回查询结果集中的第一条记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Take</span><span class="p">(</span><span class="nx">dest</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">conds</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于开启一个新的数据库事务, 并在该事务中执行指定的函数. 如果函数执行成功, 则事务将被提交, 否则将回滚.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Transaction</span><span class="p">(</span><span class="nx">fc</span> <span class="kd">func</span><span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="kt">error</span><span class="p">,</span> <span class="nx">opts</span> <span class="o">...*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">TxOptions</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将查询转换为 SQL 语句和参数. 该方法返回查询的 SQL 语句和参数列表, 以便您可以直接使用它们执行原生的 SQL 查询.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">ToSQL</span><span class="p">(</span><span class="nx">queryFn</span> <span class="kd">func</span><span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于注册指定的插件. 插件是 GORM 中用于增强或扩展功能的可插拔组件.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Use</span><span class="p">(</span><span class="nx">plugin</span> <span class="nx">gorm</span><span class="p">.</span><span class="nx">Plugin</span><span class="p">)</span> <span class="kt">error</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于取消当前查询的软删除过滤器. 在 GORM 中, 软删除是一种标记删除的方式, 它将数据的删除标记设置为 true, 而不是从数据库中永久删除数据. 当执行查询时, GORM 会默认使用软删除过滤器来排除被标记为已删除的数据. 通过 Unscoped 方法, 可以取消软删除过滤器, 并返回所有记录, 包括被标记为已删除的记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Unscoped</span><span class="p">()</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于更新数据库表中的记录. 通过指定要更新的列名和新的值, 可以更新符合指定条件的一组记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Update</span><span class="p">(</span><span class="nx">column</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将一个结构体实例中的字段值映射到数据库表中的列, 并更新符合指定条件的一组记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Updates</span><span class="p">(</span><span class="nx">values</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于更新数据库表中的单个列. 与 Updates 方法不同, UpdateColumn 方法只会更新指定的列, 而不会将结构体中的其他字段值映射到数据库表中.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">UpdateColumn</span><span class="p">(</span><span class="nx">column</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">value</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将一个结构体实例中的字段值映射到数据库表中的列, 并更新符合指定条件的一组记录.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">UpdateColumns</span><span class="p">(</span><span class="nx">values</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于将指定的上下文对象与数据库操作相关联. 在某些情况下, 您可能需要在数据库操作中使用上下文对象, 例如在处理 Web 请求时.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">WithContext</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 用于指定一个查询条件. 使用 Where 方法, 您可以指定一个 SQL 表达式或结构体, 它将被转换为 SQL 表达式, 以及与该表达式一起使用的参数.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">Where</span><span class="p">(</span><span class="nx">query</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">args</span> <span class="o">...</span><span class="kd">interface</span><span class="p">{})</span> <span class="p">(</span><span class="nx">tx</span> <span class="o">*</span><span class="nx">gorm</span><span class="p">.</span><span class="nx">DB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    


<footer id="article-footer">
  <time id="article-last-updated" datetime="0001-01-01"><i class="icon icon-calendar"></i>&nbsp;Last updated: 0001-01-01</time>

  
    <a id="article-prev-link" href="../../../single/advanced-data-processing/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#使用的开源库">使用的开源库</a></li>
    <li><a href="#服务提供者">服务提供者</a>
      <ul>
        <li><a href="#服务标识符">服务标识符</a></li>
        <li><a href="#注册服务">注册服务</a></li>
        <li><a href="#注册服务格式见-auth-服务">注册服务格式见 auth 服务</a></li>
      </ul>
    </li>
    <li><a href="#依赖的服务">依赖的服务</a></li>
    <li><a href="#env-配置">ENV 配置</a></li>
    <li><a href="#服务接口方法">服务接口方法</a></li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://falling-ts.github.io" target="_blank">
      <i class="icon icon-copyright"></i> 2024 falling-ts
    </a>
  </div>

  
  <div id="site-footer-social">

    

    

    

    

  </div>

  
  <div id="site-footer-fund">

    

    

  </div>

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://docura.github.io/" target="_blank">Docura</a>
  </div>
</footer>
    






<script type="text/javascript" src="../../../js/base.min.js"></script>



  
  <script src="../../../js/component/docsearch.min.js"></script>
  <script type="application/javascript">
      docsearch({
          container: '#site-header-search',
          appId: '',
          indexName: '',
          apiKey: '',
      });
  </script>


<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2024-11-24')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>