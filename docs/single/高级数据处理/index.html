<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Go/Gin Gower 是一个基于 Go 语言和 Gin 框架的项目。该项目旨在提供一个高性能、易扩展的 Web 应用程序框架，适用于各种后端开发需求。Go 语言以其简洁的语法、高效的性能和强大的并发支持而闻名，而 Gin 框架则提供了简洁的 API 设计和高效的路由处理机制，使得开发 Web 应用变得更加简单和高效。">
<meta name="author" content="falling-ts">
<meta name="keywords" content="Go, Gin, Gower, Spring Boot, Spring MVC, Laravel, Web 开发, 后端开发, RESTful API, 中间件, 路由, MVC 架构, 依赖注入, ORM, 数据库集成, 认证, 授权, 缓存, 性能优化, 测试, 持续集成, Docker, Kubernetes, 微服务, API 网关, 前端集成, 安全, 可扩展性, 部署, 容器化, 云服务, DevOps, API 文档, GraphQL, WebSocket, 无服务器, 事件驱动架构, 响应式编程, 负载均衡, 监控, 日志, 错误处理, 数据验证, 会话管理, 内容分发网络 (CDN), 静态文件服务, 模板引擎, 实时应用, 跨域资源共享 (CORS), JSON, XML, YAML, HTTP/2, HTTPS, SSL/TLS, OAuth, JWT, OpenAPI, Swagger, Postman, Git, 版本控制, 代码审查, 敏捷开发, 持续部署, 基础设施即代码 (IaC), Ansible, Terraform, AWS, Azure, Google Cloud Platform (GCP), Heroku, DigitalOcean, VPS, 虚拟机, 服务器管理, 网络配置, 域名系统 (DNS), 子域名, 反向代理, Nginx, Apache, 负载测试, 压力测试, 性能调优, 性能分析, 调试, 单元测试, 集成测试, 端到端测试, 测试驱动开发 (TDD), 行为驱动开发 (BDD), 代码覆盖率, 代码质量, 代码检查, 代码格式化, 静态分析, 动态分析, 安全审计, 渗透测试, 漏洞扫描, 合规性, GDPR, HIPAA, PCI DSS, ISO 27001, 可访问性, 国际化 (i18n), 本地化 (l10n), 用户体验 (UX), 用户界面 (UI), 响应式设计, 移动优先, 进步式 Web 应用 (PWA), 单页应用 (SPA), 多租户应用, SaaS, B2B, B2C, 电子商务, 支付网关, 分析, A/B 测试, 用户反馈, 客户支持, 社区建设, 文档, 教程, 最佳实践, 案例研究, 基准测试, 性能指标, 可扩展性指标, 可靠性指标, 可用性指标, 延迟, 吞吐量, 并发, 线程, 异步编程, 非阻塞 I/O, 事件循环, 回调, 承诺, 异步/等待, 协程, 通道, 协程, 演员模型, 消息队列, 发布/订阅, 事件溯源, 命令查询职责分离 (CQRS), 领域驱动设计 (DDD), 六边形架构, 清洁架构, 层次架构, 微内核架构, 服务导向架构 (SOA), 无服务器架构, 单体架构, 混合架构, 多语言持久化, NoSQL, SQL, 关系型数据库, 非关系型数据库, 时间序列数据库, 图数据库, 文档存储, 键值存储, 内存数据库, 分布式数据库, 数据仓库, 大数据, 数据分析, 机器学习, 人工智能, 自然语言处理 (NLP), 计算机视觉, 机器人, 物联网 (IoT), 边缘计算, 雾计算, 量子计算, 区块链, 智能合约, 去中心化应用 (dApps), Web3, 加密货币, NFT, 元宇宙, 虚拟现实 (VR), 增强现实 (AR), 混合现实 (MR), 扩展现实 (XR)">

<meta name="msvalidate.01" content="619B654428B21D3DEFD979542A5D45CE" />
<meta name="google-site-verification" content="GjuI1YlweThy0fSzTrpLNqvlH_ACS783cBNaPfzqlYk" />

<title>高级数据处理 · Go/Gin Gower 文档</title>

<link rel="canonical" href="../../single/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">









<link rel="stylesheet" href="../../scss/base.css" integrity="">



<link rel="stylesheet" href="../../scss/theme/default.css" integrity="">



<link rel="manifest" href="../../manifest.json">
<link rel="icon" href="../../img/icon/favicon.ico">
<link rel="icon" href="../../img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="../../img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="../../img/icon/icon-180.png" sizes="180x180">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-00000000"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-00000000');
</script>


  

  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="../../">Go/Gin Gower 文档</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          
          <li role="menuitem"><a href="../../single/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">中文</a></li>
          
          <li role="menuitem"><a href="../../en/single/advanced-data-processing/">English</a></li>
          
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="../../" ><svg t="1731853730249" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="883" width="200" height="200"><path d="M466.48888853 821.99893333A182.13546667 182.13546667 0 0 1 512 463.64444479a182.0444448 182.0444448 0 0 1 45.51111147 358.35448854V918.75555519h227.5555552v-364.08888853a45.51111147 45.51111147 0 0 1 45.51111146-45.51111147h17.93137707L512 206.27911146 175.4908448 509.15555519H193.42222187a45.51111147 45.51111147 0 0 1 45.51111146 45.51111147v364.08888853h91.02222187a45.51111147 45.51111147 0 0 1 0 91.02222294H193.42222187a45.51111147 45.51111147 0 0 1-45.5111104-45.51111147v-364.08888853H56.88888853c-41.68817813 0-61.44-51.4275552-30.44693333-79.32586667l455.11111147-409.6a45.51111147 45.51111147 0 0 1 60.89386666 0l455.11111147 409.6C1028.55111147 548.75022186 1008.79928853 600.17777813 967.11111147 600.17777813h-91.02222294v364.08888853a45.51111147 45.51111147 0 0 1-45.5111104 45.51111147h-318.57777813a45.51111147 45.51111147 0 0 1-45.51111147-45.51111147v-142.26773333zM512 736.71111146a91.02222187 91.02222187 0 1 0 0-182.0444448 91.02222187 91.02222187 0 0 0 0 182.0444448z" fill="#2c2c2c" p-id="884"></path></svg>首页</a></li>
        
          
          <li><a href="../../workspace/%E4%BB%8B%E7%BB%8D/" ><svg t="1731853749882" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1030" width="200" height="200"><path d="M941.48136843 320.91117833a58.73434594 58.73434594 0 0 0-29.56686-50.74309969L546.72469031 61.2022452a58.73434594 58.73434594 0 0 0-58.73434594 1e-8l-363.59044406 211.76239406a58.73434594 58.73434594 0 0 0-28.76811094 51.14247468v420.72729094a58.73434594 58.73434594 0 0 0 29.56592344 50.74309969l363.59231906 208.16614594a58.73434594 58.73434594 0 0 0 58.33403344 0l365.18981812-210.9627075a58.73434594 58.73434594 0 0 0 29.56686-51.14247469zM516.75939281 122.73315177l307.65453375 176.20303781-141.84086625 90.69745406-134.24993344-76.71371156a59.93247001 59.93247001 0 0 0-59.9315325 0L353.74134843 392.8305177l-142.24024125-91.4971425z m0 567.76284281l-119.86494094-69.12184125 114.27181875-70.72121437L623.43746437 630.56352364zM382.11008437 453.96111177l105.480885-61.53090656v105.48182249a25.17186281 25.17186281 0 0 0 0 2.79656063h-4.39499719l-100.68745031 64.32840562z m161.81804437 44.35029094V388.83489458l112.27400719 63.12840563V581.41792302L542.72812967 501.50827583a27.56904844 27.56904844 0 0 0 2e-8-4.79437312zM163.55550562 351.27678833l150.6308625 95.49276469v170.60803968a59.93247001 59.93247001 0 0 0 29.96623501 51.54278719l140.64180561 79.90964813v173.00616375l-319.64046561-183.39365907z m389.56199344 570.9587775V749.23033958l141.44055468-79.90964719a59.93247001 59.93247001 0 0 0 29.9671725-51.94216219V445.57049146l150.23148844-95.09245313V737.6428452z m0 0" fill="#2c2c2c" p-id="1031"></path></svg>工作区模式</a></li>
        
          
          <li><a href="../../single/%E5%89%8D%E8%A8%80/" ><svg t="1731853765799" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1314" width="200" height="200"><path d="M512 57.5822816c-262.31427627 0-475.75105173 213.43493973-475.75105173 475.75105173 0 262.3491392 213.40191147 475.75105173 475.75105173 475.75105173S987.75105173 795.68247253 987.75105173 533.33333333C987.75105173 271.01905706 774.3491392 57.5822816 512 57.5822816zM512 940.8177184c-224.6992608 0-407.48438507-182.81815147-407.48438507-407.48438507 0-224.6992608 182.78328853-407.48438507 407.48438507-407.48438507 224.66623253 0 407.48438507 182.78328853 407.48438507 407.48438507C919.48438507 757.99956586 736.66623253 940.8177184 512 940.8177184z" fill="#2c2c2c" p-id="1315"></path><path d="M512 362.667584c-94.1054304 0-170.667584 76.56031893-170.667584 170.66574933s76.56031893 170.667584 170.667584 170.667584 170.667584-76.56031893 170.667584-170.667584S606.1054304 362.667584 512 362.667584z" fill="#2c2c2c" p-id="1316"></path></svg>单项目模式</a></li>
        
      </ul>
    </nav>
  </div>

  
  <div id="site-header-search"></div>
</header>
    
<div id="site-main-content-wrapper">
  
  
    


<aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">介绍</strong>
          
          <a id="zh-0-0" class="sidebar-link " href="../../single/%E5%89%8D%E8%A8%80/#zh-0-0">
            
              前言
            
          </a>

        
          
          <a id="zh-0-1" class="sidebar-link " href="../../single/%E5%AE%89%E8%A3%85/#zh-0-1">
            
              安装
            
          </a>

        
          
          <a id="zh-0-2" class="sidebar-link " href="../../single/%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/#zh-0-2">
            
              目录结构
            
          </a>

        <strong class="sidebar-section">基础内容</strong>
          
          <a id="zh-1-0" class="sidebar-link " href="../../single/%E8%B7%AF%E7%94%B1/#zh-1-0">
            
              路由
            
          </a>

        
          
          <a id="zh-1-1" class="sidebar-link " href="../../single/%E6%8E%A7%E5%88%B6%E5%99%A8/#zh-1-1">
            
              控制器
            
          </a>

        
          
          <a id="zh-1-2" class="sidebar-link " href="../../single/%E8%AF%B7%E6%B1%82%E9%AA%8C%E8%AF%81%E5%99%A8/#zh-1-2">
            
              请求验证器
            
          </a>

        
          
          <a id="zh-1-3" class="sidebar-link " href="../../single/%E5%BC%82%E5%B8%B8/#zh-1-3">
            
              异常
            
          </a>

        
          
          <a id="zh-1-4" class="sidebar-link " href="../../single/%E5%93%8D%E5%BA%94/#zh-1-4">
            
              响应
            
          </a>

        <strong class="sidebar-section">前端相关</strong>
          
          <a id="zh-2-0" class="sidebar-link " href="../../single/%E6%A8%A1%E6%9D%BF/#zh-2-0">
            
              模板
            
          </a>

        
          
          <a id="zh-2-1" class="sidebar-link " href="../../single/%E5%89%8D%E7%AB%AF%E6%9E%84%E5%BB%BA/#zh-2-1">
            
              前端构建
            
          </a>

        
          
          <a id="zh-2-2" class="sidebar-link " href="../../single/%E6%89%93%E5%8C%85/#zh-2-2">
            
              打包
            
          </a>

        <strong class="sidebar-section">服务介绍</strong>
          
          <a id="zh-3-0" class="sidebar-link " href="../../single/auth-jwt%E6%9C%8D%E5%8A%A1/#zh-3-0">
            
              auth-JWT服务
            
          </a>

        
          
          <a id="zh-3-1" class="sidebar-link " href="../../single/cache-%E7%BC%93%E5%AD%98%E6%9C%8D%E5%8A%A1/#zh-3-1">
            
              cache-缓存服务
            
          </a>

        
          
          <a id="zh-3-2" class="sidebar-link " href="../../single/config-%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1/#zh-3-2">
            
              config-配置服务
            
          </a>

        
          
          <a id="zh-3-3" class="sidebar-link " href="../../single/cookie-cookie%E6%9C%8D%E5%8A%A1/#zh-3-3">
            
              cookie-Cookie服务
            
          </a>

        
          
          <a id="zh-3-4" class="sidebar-link " href="../../single/db-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1/#zh-3-4">
            
              db-数据库服务
            
          </a>

        
          
          <a id="zh-3-5" class="sidebar-link " href="../../single/exception-%E5%BC%82%E5%B8%B8%E6%9C%8D%E5%8A%A1/#zh-3-5">
            
              exception-异常服务
            
          </a>

        
          
          <a id="zh-3-6" class="sidebar-link " href="../../single/logger-%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1/#zh-3-6">
            
              logger-日志服务
            
          </a>

        
          
          <a id="zh-3-7" class="sidebar-link " href="../../single/passwd-%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E6%9C%8D%E5%8A%A1/#zh-3-7">
            
              passwd-密码哈希服务
            
          </a>

        
          
          <a id="zh-3-8" class="sidebar-link " href="../../single/response-%E5%93%8D%E5%BA%94%E6%9C%8D%E5%8A%A1/#zh-3-8">
            
              response-响应服务
            
          </a>

        
          
          <a id="zh-3-9" class="sidebar-link " href="../../single/route-%E8%B7%AF%E7%94%B1%E6%9C%8D%E5%8A%A1/#zh-3-9">
            
              route-路由服务
            
          </a>

        
          
          <a id="zh-3-10" class="sidebar-link " href="../../single/symcrypt-%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%9C%8D%E5%8A%A1/#zh-3-10">
            
              symcrypt-对称加密服务
            
          </a>

        
          
          <a id="zh-3-11" class="sidebar-link " href="../../single/translate-%E7%BF%BB%E8%AF%91%E6%9C%8D%E5%8A%A1/#zh-3-11">
            
              translate-翻译服务
            
          </a>

        
          
          <a id="zh-3-12" class="sidebar-link " href="../../single/upload-%E4%B8%8A%E4%BC%A0%E6%9C%8D%E5%8A%A1/#zh-3-12">
            
              upload-上传服务
            
          </a>

        
          
          <a id="zh-3-13" class="sidebar-link " href="../../single/util-%E5%B7%A5%E5%85%B7%E6%9C%8D%E5%8A%A1/#zh-3-13">
            
              util-工具服务
            
          </a>

        
          
          <a id="zh-3-14" class="sidebar-link " href="../../single/validator-%E9%AA%8C%E8%AF%81%E6%9C%8D%E5%8A%A1/#zh-3-14">
            
              validator-验证服务
            
          </a>

        <strong class="sidebar-section">第三方应用</strong>
          
          <a id="zh-4-0" class="sidebar-link " href="../../single/caddy-web-%E6%9C%8D%E5%8A%A1%E5%99%A8/#zh-4-0">
            
              Caddy Web 服务器
            
          </a>

        
          
          <a id="zh-4-1" class="sidebar-link " href="../../single/%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B%E5%99%A8/#zh-4-1">
            
              日志查看器
            
          </a>

        
          
          <a id="zh-4-2" class="sidebar-link " href="../../single/%E6%95%B0%E6%8D%AE%E5%BA%93/#zh-4-2">
            
              数据库
            
          </a>

        <strong class="sidebar-section">发布</strong>
          
          <a id="zh-5-0" class="sidebar-link " href="../../single/%E5%8F%91%E5%B8%83%E5%89%8D%E8%A8%80/#zh-5-0">
            
              发布前言
            
          </a>

        
          
          <a id="zh-5-1" class="sidebar-link " href="../../single/%E5%8F%91%E5%B8%83%E5%BC%80%E5%8F%91/#zh-5-1">
            
              发布开发
            
          </a>

        
          
          <a id="zh-5-2" class="sidebar-link " href="../../single/%E5%8F%91%E5%B8%83%E6%B5%8B%E8%AF%95/#zh-5-2">
            
              发布测试
            
          </a>

        
          
          <a id="zh-5-3" class="sidebar-link " href="../../single/%E5%8F%91%E5%B8%83%E7%94%9F%E4%BA%A7/#zh-5-3">
            
              发布生产
            
          </a>

        <strong class="sidebar-section">其他</strong>
          
          <a id="zh-6-0" class="sidebar-link " href="../../single/%E9%85%8D%E7%BD%AE/#zh-6-0">
            
              配置
            
          </a>

        
          
          <a id="zh-6-1" class="sidebar-link " href="../../single/%E6%B5%8B%E8%AF%95/#zh-6-1">
            
              测试
            
          </a>

        
          
          <a id="zh-6-2" class="sidebar-link " href="../../single/%E5%B7%A5%E5%85%B7/#zh-6-2">
            
              工具
            
          </a>

        
          
          <a id="zh-6-3" class="sidebar-link " href="../../single/%E5%91%BD%E4%BB%A4/#zh-6-3">
            
              命令
            
          </a>

        
          
          <a id="zh-6-4" class="sidebar-link current" href="../../single/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/#zh-6-4">
            
              高级数据处理
            
          </a>

        
  </div>
</aside>

  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  <button id="article-nav-toc-btn"><i class="icon icon-toc"></i> On this page</button>
</nav>
      <header id="article-header">
  <h1>高级数据处理</h1>
</header>
      <div id="article-content">
        
        
        <p>模型, 是来源数据的结果中心; 数据库可以算作是来源数据的最终归宿.</p>
<p>反方向同理, 数据库和模型是前端数据的源头.</p>
<h2 id="面向过程-与-面向数据">面向过程 与 面向数据</h2>
<p>面向过程, 是指处理数据, 一个一个字段的来, 通过传统赋值来把来源数据, 赋值到目标数据上</p>
<blockquote>
<p>优点, 简单直接, 性能好, 适合逻辑清晰, 数据量小的情况</p>
<p>缺点, 数据量一多, 处理繁琐, 维护起来越来越难</p>
</blockquote>
<p>面向数据, 是指通过映射规则, 把来源数据赋值到目标数据上</p>
<blockquote>
<p>优点, 数据结果一目了然, 逻辑清晰, 数据量大小均可使用</p>
<p>缺点, 使用理解需要花时间, 并且有一定性能损耗</p>
</blockquote>
<h2 id="模型">模型</h2>
<p>我们把模型类比为一栋房屋, 房屋内部声明了一个个数据的座位.</p>
<p>门口有两个门卫, 一个门卫负责对进来的数据进行处理, 就叫他 In 吧; 一个门卫负责则对出去的数据进行处理, 就叫他 Out 吧.</p>
<p>假设这个房屋名字叫 Article, 是存放文章的模型.</p>
<p>结构如下:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Article</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Model</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Title</span>      <span class="kt">string</span>  <span class="s">`gorm:&#34;type:string;default:&#39;&#39;;not null;commit:标题&#34;`</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Content</span>    <span class="o">*</span><span class="kt">string</span> <span class="s">`gorm:&#34;type:text;commit:内容&#34;`</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 所属类别
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">CategoryID</span> <span class="o">*</span><span class="kt">uint</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Category</span>   <span class="o">*</span><span class="nx">TestCategory</span> <span class="s">`gorm:&#34;foreignKey:CategoryID&#34;`</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 所属作者
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">UserID</span>     <span class="o">*</span><span class="kt">uint</span>
</span></span><span class="line"><span class="cl">    <span class="nx">User</span>       <span class="o">*</span><span class="nx">TestUser</span>     <span class="s">`gorm:&#34;foreignKey:UserID&#34;`</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 文章评论
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">Comments</span>   <span class="p">[]</span><span class="nx">TestComment</span> <span class="s">`gorm:&#34;foreignKey:ArticleID&#34;`</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>假设有个控制器方法, 是添加文章</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="o">*</span><span class="nx">ArticleController</span><span class="p">)</span> <span class="nf">Store</span><span class="p">(</span><span class="nx">req</span> <span class="o">*</span><span class="nx">requests</span><span class="p">.</span><span class="nx">ArticleRequest</span><span class="p">,</span> <span class="nx">article</span> <span class="o">*</span><span class="nx">models</span><span class="p">.</span><span class="nx">Article</span><span class="p">,</span> <span class="nx">auth</span> <span class="o">*</span><span class="nx">models</span><span class="p">.</span><span class="nx">Auth</span><span class="p">)</span> <span class="p">(</span><span class="nx">services</span><span class="p">.</span><span class="nx">Response</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//TODO: 处理与保存数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nf">Ok</span><span class="p">(</span><span class="s">&#34;添加成功&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>req 数据已经经过校验, 必填都会必填</p>
</blockquote>
<h3 id="面向过程处理">面向过程处理</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">article</span><span class="p">.</span><span class="nx">Title</span> <span class="p">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">Title</span>
</span></span><span class="line"><span class="cl"><span class="nx">article</span><span class="p">.</span><span class="nx">Content</span> <span class="p">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">Content</span>
</span></span><span class="line"><span class="cl"><span class="nx">article</span><span class="p">.</span><span class="nx">CategoryID</span> <span class="p">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">CategoryID</span>
</span></span><span class="line"><span class="cl"><span class="nx">article</span><span class="p">.</span><span class="nx">UserID</span> <span class="p">=</span> <span class="nx">auth</span><span class="p">.</span><span class="nx">ID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">result</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="nx">article</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">result</span><span class="p">.</span><span class="nx">Error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">excp</span><span class="p">.</span><span class="nf">BadRequest</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">Error</span><span class="p">,</span> <span class="s">&#34;添加失败&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="面向数据处理-in-处理">面向数据处理, In 处理</h3>
<p>我们来看一下如何面向数据, 进行处理.</p>
<p>首先这种情况就是 In 门卫, 将 req 的数据, 放入屋子内对应的座位上.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">article</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">article</span><span class="p">.</span><span class="nf">In</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;title&#34;</span><span class="p">:</span> <span class="s">&#34;title&#34;</span><span class="p">,</span> <span class="c1">// 首字母大不大写, 无所谓, 内部自动转换为首字母大写.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s">&#34;_skips&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Skips</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;userId&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">()</span> <span class="kt">uint</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">auth</span><span class="p">.</span><span class="nx">ID</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">excp</span><span class="p">.</span><span class="nf">BadRequest</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">result</span> <span class="o">:=</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="nx">article</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">result</span><span class="p">.</span><span class="nx">Error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">excp</span><span class="p">.</span><span class="nf">BadRequest</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">Error</span><span class="p">,</span> <span class="s">&#34;添加失败&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="关于-apprule">关于 <code>app.Rule</code></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Rule</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">any</span>
</span></span></code></pre></div><blockquote>
<p>string, 代表模型的字段, 有时也代表 req 的字段</p>
<p>any, 分为 string, map, struct, func 四大类</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">string 时, 代表 req 的字段</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">map 时, 代表 app.Rule 本身, 意思是又有一套 Rule 规则, 处理模型中的模型数据, 实现一个递归处理, 理论上无限深层处理.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">struct 时, 有严格规定的格式, 如下</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">struct{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="l">Args []string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="l">Func func (title string) string // 函数定义, 根据实际变化万千</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Args</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="l">string{&#34;title&#34;},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">Func</span><span class="p">:</span><span class="w"> </span><span class="l">func(title string) string {</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="l">return title</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">这样做, 参数可以有多个或没有.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">func 时, 其实实现的功能和 struct 一样, 只是函数定义, 参数有固定格式</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">func (req any) string {}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">func () string {}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">即, 参数有一个或没有.</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>为什么函数处理要这么麻烦, 主要是因为函数反射后, 会丢失参数名, 也就是说, 函数反射运行时, 只保留类型, 反射调用时, 将参数以顺序方式放入切片, 最后传入调用的函数中.</p>
</blockquote>
<h4 id="关于-_skips-appskips">关于 <code>&quot;_skips&quot;: app.Skips{},</code></h4>
<p>规则映射赋值, 分为仅仅模式和跳过模式.</p>
<p>仅仅模式: 就是数据赋值时, 仅赋值 app.Rule 内定义的字段, 没有定义的字段将使用类型的零值, 在不加 &ldquo;_skips&rdquo; 时, 这就是默认模式.
跳过模式: 就是数据赋值时, 根据模型内定义的所有字段, 依次从 req 中取同名字段的值, 如果是 app.Skips{&ldquo;title&rdquo;}, 则跳过 title , 赋值其它字段.</p>
<h3 id="面向数据处理-out-处理">面向数据处理, Out 处理</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">data</span> <span class="o">:=</span> <span class="nx">article</span><span class="p">.</span><span class="nf">Out</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;_skips&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Skips</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><blockquote>
<p>处理规则与 In 一致</p>
<p>返回的数据格式默认是 map[string]any</p>
<p>数据键的字符串格式受 env 环境的 RES_KEY_TYPE 影响.</p>
</blockquote>
<h2 id="稍微全一些的数据处理示例">稍微全一些的数据处理示例</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">out</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">user</span><span class="p">.</span><span class="nf">Out</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;_skips&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Skips</span><span class="p">{</span><span class="s">&#34;password&#34;</span><span class="p">,</span> <span class="s">&#34;deleted_at&#34;</span><span class="p">},</span> <span class="c1">// 跳过密码和删除时间, 转换其它字段
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s">&#34;user_info&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="s">&#34;Nickname&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">struct</span> <span class="p">{</span> <span class="c1">// 处理头像, 添加 app.url
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">Args</span> <span class="p">[]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Func</span> <span class="kd">func</span><span class="p">(</span><span class="nx">avatar</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">        <span class="p">}{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Args</span><span class="p">:</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&#34;avatar&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Func</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">avatar</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span> <span class="o">+</span> <span class="nx">avatar</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;categories&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;Name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;children&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;Name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;articles&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;title&#34;</span><span class="p">:</span> <span class="s">&#34;Title&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;comments&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span> <span class="c1">// 处理 nickname
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                            <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;children&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                            <span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                            <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;articles&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;title&#34;</span><span class="p">:</span>   <span class="s">&#34;Title&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;comments&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;children&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                    <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;comments&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;content&#34;</span><span class="p">:</span> <span class="s">&#34;Content&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;parent&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;article&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;id&#34;</span><span class="p">:</span>    <span class="s">&#34;ID&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;title&#34;</span><span class="p">:</span> <span class="s">&#34;title&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Rule</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;username&#34;</span><span class="p">:</span> <span class="s">&#34;Username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;nickname&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Nickname</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;avatar&#34;</span><span class="p">:</span> <span class="kd">func</span><span class="p">(</span><span class="nx">user</span> <span class="nx">models</span><span class="p">.</span><span class="nx">TestUser</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s%s&#34;</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Url</span><span class="p">,</span> <span class="o">*</span><span class="nx">user</span><span class="p">.</span><span class="nx">UserInfo</span><span class="p">.</span><span class="nx">Avatar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div>
      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

      
    


<footer id="article-footer">
  <time id="article-last-updated" datetime="2024-11-24"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2024-11-24</time>

  
    <a id="article-prev-link" href="../../single/%E5%91%BD%E4%BB%A4/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#面向过程-与-面向数据">面向过程 与 面向数据</a></li>
    <li><a href="#模型">模型</a>
      <ul>
        <li><a href="#面向过程处理">面向过程处理</a></li>
        <li><a href="#面向数据处理-in-处理">面向数据处理, In 处理</a></li>
        <li><a href="#面向数据处理-out-处理">面向数据处理, Out 处理</a></li>
      </ul>
    </li>
    <li><a href="#稍微全一些的数据处理示例">稍微全一些的数据处理示例</a></li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://falling-ts.github.io" target="_blank">
      <i class="icon icon-copyright"></i> 2024 falling-ts
    </a>
  </div>

  
  <div id="site-footer-social">

    

    

    

    

  </div>

  
  <div id="site-footer-fund">

    

    

  </div>

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://docura.github.io/" target="_blank">Docura</a>
  </div>
</footer>
    






<script type="text/javascript" src="../../js/base.min.js"></script>




<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2024-11-24')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>